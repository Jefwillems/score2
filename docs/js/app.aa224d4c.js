(function(t){function e(e){for(var o,i,r=e[0],c=e[1],l=e[2],p=0,h=[];p<r.length;p++)i=r[p],n[i]&&h.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],o=!0,r=1;r<s.length;r++){var c=s[r];0!==n[c]&&(o=!1)}o&&(a.splice(e--,1),t=i(i.s=s[0]))}return t}var o={},n={app:0},a=[];function i(e){if(o[e])return o[e].exports;var s=o[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=o,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var d=c;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"56d7":function(t,e,s){"use strict";s.r(e);var o=s("2b0e"),n=s("bb71");s("da64");o["a"].use(n["a"],{iconfont:"md"});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[s("v-content",[s("Graph")],1)],1)},i=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"explorerContainer"},[""!==t.topic?s("div",{attrs:{id:"topic"}},[s("h3",{staticClass:"text-xs-center"},[t._v("\n      Current topic:\n      "),s("span",[t._v(t._s(t.topic))])])]):t._e(),s("div",{ref:"graph",attrs:{id:"graph"}}),s("div",{attrs:{id:"btns"}},[s("v-btn",{attrs:{id:"reloadBtn",color:"warning"},on:{click:t.reload}},[t._v(t._s(t.btnText))]),s("v-btn",{attrs:{id:"demoBtn",color:"primary"},on:{click:t.enableDemo}},[t._v(t._s(t.demoBtnText))]),s("v-btn",{attrs:{id:"physicsBtn",color:"secondary"},on:{click:t.swapPhysics}},[t._v(t._s(t.physicsText))])],1),s("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",{attrs:{color:"primary",dark:""}},[s("v-card-text",[t._v("Please stand by\n        "),s("v-progress-linear",{staticClass:"mb-0",attrs:{color:"white",indeterminate:""}})],1)],1)],1)],1)},c=[],l=s("2f62"),d={MUTATE_RAW_DATA:"mutate_raw_data",FETCH_SPREADSHEET_DATA:"fetch_spreadsheet",HANDLE_CLICK:"handle_click",RESET_BUTTON:"reset_button",SELECT_CITY:"select_city",SWAP_DEMO:"swap_demo_mode",SWAP_PHYSICS:"swap_physics"},p=s("2ef0");const h={shape:"hexagon",mass:3,fixed:!1,font:{size:18},clickable:!0},u={...h,type:"city",color:"rgba(57,62,70,1)"},b={...h,type:"keywords",color:"rgba(0, 173, 181, 1)"},m={...h,type:"challenge",color:"rgba(248, 181, 0, 1)"},f={...h,type:"topics",color:"rgba(252, 60, 60, 1)"},g={clickable:!1,fixed:!0,physics:!1,size:25},_=[{...u,...g,x:25,y:0,label:"city"},{...b,...g,x:25,y:50,label:"keyword"},{...m,...g,x:25,y:100,label:"challenge"},{...f,...g,x:25,y:150,label:"topic"}];var y=s("e9a8"),w=s.n(y),v=s("dd61"),k=s.n(v),T=s("2769"),x=s.n(T),O=s("a8fc"),E=s.n(O),S=s("6cd4"),j=s.n(S);function D(t){const e=t=>{e.graph||(e.graph={nodes:[...e.data],edges:[]}),j()(e.data,s=>{const o=s[t];j()(o,t=>{x()(e.graph.nodes,e=>e.label===t.label)||e.graph.nodes.push(t)})});const s=w()(e.data,s=>{const o=E()(s[t],"label");return k()(o,t=>{const o=x()(e.graph.nodes,e=>{return e.label===t.label});return{from:s.id,to:(o||t).id}})});e.graph.edges.push(...s);const o=w()(e.data,e=>e[t]);return e.data=o,e};return e.data=t,e}var A=s("4f27");const $=t=>{let e=0;return t.entry.map(t=>{const{gsx$city:{$t:s},gsx$contact:{$t:o},gsx$description:{$t:n},gsx$keywords:{$t:a},gsx$title:{$t:i},gsx$topics:{$t:r}}=t,c={city:s,contact:o,description:n,title:i,keywords:a.split(", ").filter(t=>""!==t),topics:r.split(", ").filter(t=>""!==t),id:++e,label:s};return c})},C=t=>{return Object(p["uniqBy"])(t,"city").map(t=>t.city).filter(t=>""!==t)},P=(t,e)=>{const s=C(t);let o=0;return Object(p["compact"])(Object(p["map"])(s,s=>{const n=Object(p["filter"])(t,t=>t.city===s&&Object(p["includes"])(t.topics,e));return n.length<=0?null:{challenges:Object(p["map"])(n,t=>({...t,...m,label:t.title,id:++o,keywords:Object(p["map"])(t.keywords,t=>({...b,label:t,id:++o}))})),...u,label:s,id:++o}}))},M=t=>{const e=C(t);let s=0;return Object(p["map"])(e,e=>{const o=Object(p["filter"])(t,t=>t.city===e),n=Object(p["flatMap"])(o,t=>t.topics);return{...u,label:e,id:++s,topics:Object(p["map"])(n,t=>({...f,label:t,id:++s}))}})};var H={mutate_raw_data(t,{feed:e}){const s=$(e);t.raw_data=s;const o=D(M(s))("topics").graph;t.graph={nodes:new A["DataSet"](o.nodes),edges:new A["DataSet"](o.edges)}},handle_click(t,e){const s=t.graph.nodes.map(t=>t),o=Object(p["find"])(s,t=>t.id===e&&"topics"===t.type);if(o){t.btnText="back",t.selected_topic={...o};const e=t.selected_topic.label;t.topic=e,t.cityToChallengeToKeyword=P(t.raw_data,e);const{graph:s}=D(P(t.raw_data,e))("challenges")("keywords");t.graph={nodes:new A["DataSet"](s.nodes),edges:new A["DataSet"](s.edges)}}},reset_button(t){t.btnText="reload"},select_city({selected_cities:t},e){t=Object(p["find"])(t,e)?Object(p["filter"])(t,t=>t===e):[...t,e]},swap_demo_mode(t){t.demo=!t.demo},swap_physics(t){t.physics=!t.physics}};const B=t=>fetch(t).then(t=>t.json());var I={fetch_spreadsheet({commit:t}){const e="https://spreadsheets.google.com/feeds/list/1adKrrgn-KxFe1mWHUXZEDvu23BIzHE2wLk2YfIQjzbM/1/public/values?alt=json";B(e).then(e=>{t(d.MUTATE_RAW_DATA,e),t(d.RESET_BUTTON)}).catch(t=>console.log(t))}},W={get_network({graph:t}){return t},get_options:({options:t})=>t,btnText:({btnText:t})=>t,cities:({cities:t})=>t,selected_cities:({selected_cities:t})=>t,topic:({topic:t})=>t,demoBtnText:({demo:t})=>t?"Disable Demo":"Enable Demo",physics:({physics:t})=>t,physicsText:({physics:t})=>t?"Disable physics":"Enable physics"};o["a"].use(l["a"]);var R=new l["a"].Store({state:{topic:"",graph:{nodes:[],edges:[]},focus:"topics",cities:[],options:{autoResize:!0,height:"100%",width:"100%",layout:{improvedLayout:!1},physics:{}},raw_data:{},btnText:"Reload",demo:!1,selected_topic:{},selected_cities:[],physics:!0},mutations:H,actions:I,getters:W});const L=_;var z={name:"Graph",props:{width:{type:String,default:function(){return"100%"}},height:{type:String,default:function(){return"100%"}}},data(){return{events:["doubleClick","selectNode","click","stabilizationIterationsDone","afterDrawing"],network:null,dialog:!1,timeout:null}},computed:{...Object(l["c"])(["demo"]),...Object(l["b"])(["get_network","get_options","btnText","topic","demoBtnText","physics","physicsText"])},watch:{get_network:function(t){null!==this.network&&this.network.destroy();const e=this.$refs.graph,s=-e.clientWidth/2-50;let o=-e.clientHeight/2-50;const n=L.map(t=>{const{font:e}=t,n={...t,x:s,y:o,font:{...e,vadjust:-12}};return o+=80,n});t.nodes.add?t.nodes.add(n):t.nodes.push(...n),this.network=new A["Network"](e,t,this.get_options),this.events.forEach(t=>this.network.on(t,e=>this.handle_event(t,e)))}},created(){},mounted(){this.dialog=!0,this.$store.state.topic="",this.$store.dispatch(d.FETCH_SPREADSHEET_DATA)},methods:{reload(){this.dialog=!0,this.demo&&(clearTimeout(this.timeout),this.$store.commit(d.SWAP_DEMO)),this.$store.state.topic="",this.$store.dispatch(d.FETCH_SPREADSHEET_DATA)},swapPhysics(){this.$store.commit(d.SWAP_PHYSICS),this.network.setOptions({physics:this.physics})},handle_event(t,e){let s,o;switch(t){case"doubleClick":s=e.nodes[0],o=this.network.body.data.nodes.map(t=>t).find(t=>t.id===s),this.dialog=!0,this.$store.commit(d.HANDLE_CLICK,s),this.demo&&(clearTimeout(this.timeout),this.$store.commit(d.SWAP_DEMO));break;case"selectNode":s=e.nodes[0],o=this.network.body.data.nodes.map(t=>t).find(t=>t.id===s),this.demo&&(clearTimeout(this.timeout),this.$store.commit(d.SWAP_DEMO)),o.clickable&&this.network.focus(s,{animation:{duration:800,easingFunction:"easeInCubic"},scale:1.2});break;case"click":0!==e.nodes.length||0!==e.edges.length||this.demo||this.network.fit({animation:{duration:800,easingFunction:"easeInCubic"},scale:1.2});break;case"afterDrawing":this.dialog=!1;break;case"stabilizationIterationsDone":this.swapPhysics();break;default:return}},enableDemo(){if(this.demo)clearTimeout(this.timeout);else{const t=20,e=()=>{const t=this.randomSecs(4,8),s=Object(p["sample"])(this.network.body.data.nodes.map(t=>t).filter(t=>t.clickable));this.network.focus(s.id,{animation:{duration:t,easingFunction:"easeOutCubic"},scale:1.1}),this.timeout=setTimeout(e,t+50)};this.timeout=setTimeout(e,t)}this.$store.commit(d.SWAP_DEMO)},randomSecs(t,e){return Math.floor(Math.random()*(1e3*e-1e3*t))+1e3*t}}},F=z,N=(s("8e60"),s("2877")),V=s("6544"),K=s.n(V),U=s("8336"),G=s("b0af"),Y=s("99d9"),J=s("169a"),q=s("8e36"),Q=Object(N["a"])(F,r,c,!1,null,null,null);Q.options.__file="Graph.vue";var X=Q.exports;K()(Q,{VBtn:U["a"],VCard:G["a"],VCardText:Y["a"],VDialog:J["a"],VProgressLinear:q["a"]});var Z={name:"App",components:{Graph:X},data(){return{}}},tt=Z,et=s("7496"),st=s("549c"),ot=Object(N["a"])(tt,a,i,!1,null,null,null);ot.options.__file="App.vue";var nt=ot.exports;K()(ot,{VApp:et["a"],VContent:st["a"]}),o["a"].config.productionTip=!1,new o["a"]({store:R,render:t=>t(nt)}).$mount("#app")},"8e60":function(t,e,s){"use strict";var o=s("af4a"),n=s.n(o);n.a},af4a:function(t,e,s){}});
//# sourceMappingURL=app.aa224d4c.js.map