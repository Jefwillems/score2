(function(t){function e(e){for(var i,s,r=e[0],c=e[1],l=e[2],p=0,u=[];p<r.length;p++)s=r[p],n[s]&&u.push(n[s][0]),n[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);d&&d(e);while(u.length)u.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],i=!0,r=1;r<o.length;r++){var c=o[r];0!==n[c]&&(i=!1)}i&&(a.splice(e--,1),t=s(s.s=o[0]))}return t}var i={},n={app:0},a=[];function s(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=i,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(o,i,function(e){return t[e]}.bind(null,i));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var d=c;a.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"56d7":function(t,e,o){"use strict";o.r(e);var i=o("2b0e"),n=o("bb71");o("da64");i["a"].use(n["a"],{iconfont:"md"});var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-app",[o("v-content",[o("Graph")],1)],1)},s=[],r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"explorerContainer"},[""!==t.topic?o("div",{attrs:{id:"topic"}},[o("h3",{staticClass:"text-xs-center"},[t._v("\n      Current topic:\n      "),o("span",[t._v(t._s(t.topic))])])]):t._e(),o("div",{ref:"graph",attrs:{id:"graph"}}),o("div",{attrs:{id:"btns"}},[o("v-btn",{attrs:{id:"reloadBtn",color:"warning"},on:{click:t.reload}},[t._v(t._s(t.btnText))]),o("v-btn",{attrs:{id:"demoBtn",color:"primary"},on:{click:t.enableDemo}},[t._v(t._s(t.demoBtnText))])],1),o("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[o("v-card",{attrs:{color:"primary",dark:""}},[o("v-card-text",[t._v("Please stand by\n        "),o("v-progress-linear",{staticClass:"mb-0",attrs:{color:"white",indeterminate:""}})],1)],1)],1)],1)},c=[],l=o("2f62"),d={MUTATE_RAW_DATA:"mutate_raw_data",FETCH_SPREADSHEET_DATA:"fetch_spreadsheet",HANDLE_CLICK:"handle_click",RESET_BUTTON:"reset_button",SELECT_CITY:"select_city",SWAP_DEMO:"swap_demo_mode"},p=o("2ef0");const u={shape:"hexagon",mass:3,fixed:!1,font:{size:18},clickable:!0},b={...u,type:"city",color:"rgba(57,62,70,1)"},h={...u,type:"keywords",color:"rgba(0, 173, 181, 1)"},f={...u,type:"challenge",color:"rgba(248, 181, 0, 1)"},m={...u,type:"topics",color:"rgba(252, 60, 60, 1)"},g={clickable:!1,fixed:!0,physics:!1,size:25},_=[{...b,...g,x:25,y:0,label:"city"},{...h,...g,x:25,y:50,label:"keyword"},{...f,...g,x:25,y:100,label:"challenge"},{...m,...g,x:25,y:150,label:"topic"}];function y(t){switch(t){case"topics":return m;case"keywords":return h;case"challenge":return f;case"city":return b;default:return{}}}const O=t=>{const e=Object(p["filter"])(Object(p["map"])(Object(p["uniqBy"])(t,"city"),t=>({name:t.city})),t=>""!==t.name),o=o=>{Object(p["forEach"])(e,e=>{e[o]=Object(p["flatMap"])(Object(p["filter"])(t,t=>t.city===e.name),t=>t[o])});const i=Object(p["uniq"])(Object(p["flatMap"])(e,t=>t[o]));let n=0;const a=Object(p["map"])(e,t=>({...b,label:t.name,id:++n,[o]:t[o]})),s=Object(p["map"])(i,t=>({...y(o),label:t,id:++n})),r=[...a,...s],c=[];Object(p["forEach"])(a,t=>{Object(p["forEach"])(t[o],e=>{c.push({from:t.id,to:s.find(t=>t.label===e).id})})});const l={nodes:r,edges:c};return l};return o};var v=o("4f27");const w=t=>{let e=0;return t.entry.map(t=>{const{gsx$city:{$t:o},gsx$contact:{$t:i},gsx$description:{$t:n},gsx$keywords:{$t:a},gsx$title:{$t:s},gsx$topics:{$t:r}}=t,c={city:o,contact:i,description:n,title:s,keywords:a.split(", ").filter(t=>""!==t),topics:r.split(", ").filter(t=>""!==t),id:++e,label:o};return c})},j=t=>{return Object(p["uniqBy"])(t,"city").map(t=>t.city).filter(t=>""!==t)},k=t=>e=>{return Object(p["flatMap"])(t,t=>t[e]).filter(t=>""!==t)};let T=null;var x={mutate_raw_data(t,{feed:e}){const o=w(e),i=j(o),n=k(o),a=n("keywords"),s=n("topics"),r=Object(p["groupBy"])(Object(p["filter"])(o,t=>""!==t.city),"city");t.raw_data=r,t.cities=i.sort(),t.selected_cities=i.sort(),t.keywords=a,t.topics=s,null===T&&(T=O(o));const c=T("topics");t.graph={nodes:new v["DataSet"](c.nodes),edges:new v["DataSet"](c.edges)}},handle_click(t,e){const o=t.graph.nodes.map(t=>t),i=Object(p["find"])(o,t=>t.id===e&&"topics"===t.type);if(i){t.btnText="back",t.selected_topic={...i},t.topic=t.selected_topic.label,console.log("clicked: ",i);const e=Object(p["map"])(t.cities,t=>({label:t,...b})),o=Object(p["filter"])(Object(p["flatMap"])(e,e=>t.raw_data[e.label]),e=>Object(p["includes"])(e.topics,t.selected_topic.label)),n=Object(p["map"])(o,t=>({label:t.title,city:t.city,...f})),a=Object(p["map"])(Object(p["uniq"])(Object(p["flatMap"])(o,t=>t.keywords)),t=>({label:t,...h}));let s=0;const r=Object(p["map"])(Object(p["concat"])(n,e,a),t=>({...t,id:++s})),c=Object(p["map"])(Object(p["filter"])(r,t=>"challenge"===t.type),t=>({from:t.id,to:Object(p["find"])(r,e=>e.label===t.city).id})),l=Object(p["flatMap"])(Object(p["filter"])(r,t=>"challenge"===t.type),e=>{const{keywords:o}=Object(p["find"])(t.raw_data[e.city],t=>t.title===e.label);return Object(p["map"])(o,t=>({from:Object(p["find"])(r,e=>e.label===t).id,to:e.id}))}),d=Object(p["concat"])(c,l);t.graph={nodes:r,edges:d}}},reset_button(t){t.btnText="reload"},select_city({selected_cities:t},e){t=Object(p["find"])(t,e)?Object(p["filter"])(t,t=>t===e):[...t,e]},swap_demo_mode(t){t.demo=!t.demo}};const E=t=>fetch(t).then(t=>t.json());var D={fetch_spreadsheet({commit:t}){const e="https://spreadsheets.google.com/feeds/list/1adKrrgn-KxFe1mWHUXZEDvu23BIzHE2wLk2YfIQjzbM/1/public/values?alt=json";E(e).then(e=>{t(d.MUTATE_RAW_DATA,e),t(d.RESET_BUTTON)}).catch(t=>console.log(t))}},A={get_network({graph:t}){return t},get_options:({options:t})=>t,btnText:({btnText:t})=>t,cities:({cities:t})=>t,selected_cities:({selected_cities:t})=>t,topic:({topic:t})=>t,demoBtnText:({demo:t})=>t?"Disable Demo":"Enable Demo"};i["a"].use(l["a"]);var S=new l["a"].Store({state:{topic:"",graph:{nodes:[],edges:[]},focus:"topics",cities:[],options:{autoResize:!0,height:"100%",width:"100%",layout:{improvedLayout:!0},physics:{}},raw_data:{},btnText:"Reload",demo:!1,selected_topic:{},selected_cities:[]},mutations:x,actions:D,getters:A});const $=_;var C={name:"Graph",props:{width:{type:String,default:function(){return"100%"}},height:{type:String,default:function(){return"100%"}}},data(){return{events:["doubleClick","selectNode","click","stabilizationIterationsDone","afterDrawing"],network:null,dialog:!1,timeout:null}},computed:{...Object(l["c"])(["demo"]),...Object(l["b"])(["get_network","get_options","btnText","topic","demoBtnText"])},watch:{get_network:function(t){null!==this.network&&this.network.destroy();const e=this.$refs.graph,o=-e.clientWidth/2-50;let i=-e.clientHeight/2-50;const n=$.map(t=>{const{font:e}=t,n={...t,x:o,y:i,font:{...e,vadjust:-12}};return i+=80,n});t.nodes.add?t.nodes.add(n):t.nodes.push(...n),this.network=new v["Network"](e,t,this.get_options),this.events.forEach(t=>this.network.on(t,e=>this.handle_event(t,e)))}},created(){},mounted(){this.dialog=!0,this.$store.state.topic="",this.$store.dispatch(d.FETCH_SPREADSHEET_DATA)},methods:{reload(){this.dialog=!0,this.demo&&(clearTimeout(this.timeout),this.$store.commit(d.SWAP_DEMO)),this.$store.state.topic="",this.$store.dispatch(d.FETCH_SPREADSHEET_DATA)},handle_event(t,e){let o,i;switch(t){case"doubleClick":o=e.nodes[0],i=this.network.body.data.nodes.map(t=>t).find(t=>t.id===o),this.dialog=!0,this.$store.commit(d.HANDLE_CLICK,o),this.demo&&(clearTimeout(this.timeout),this.$store.commit(d.SWAP_DEMO));break;case"selectNode":o=e.nodes[0],i=this.network.body.data.nodes.map(t=>t).find(t=>t.id===o),this.demo&&(clearTimeout(this.timeout),this.$store.commit(d.SWAP_DEMO)),i.clickable&&this.network.focus(o,{animation:{duration:800,easingFunction:"easeInCubic"},scale:1.2});break;case"click":0!==e.nodes.length||0!==e.edges.length||this.demo||this.network.fit({animation:{duration:800,easingFunction:"easeInCubic"},scale:1.2});break;case"afterDrawing":this.dialog=!1;break;case"stabilizationIterationsDone":this.network.setOptions({physics:!1});break;default:return}},enableDemo(){if(this.demo)clearTimeout(this.timeout);else{const t=20,e=()=>{const t=this.randomSecs(4,8),o=Object(p["sample"])(this.network.body.data.nodes.map(t=>t).filter(t=>t.clickable));this.network.focus(o.id,{animation:{duration:t,easingFunction:"easeOutCubic"},scale:1.1}),this.timeout=setTimeout(e,t+50)};this.timeout=setTimeout(e,t)}this.$store.commit(d.SWAP_DEMO)},randomSecs(t,e){return Math.floor(Math.random()*(1e3*e-1e3*t))+1e3*t}}},M=C,P=(o("8e60"),o("2877")),B=o("6544"),H=o.n(B),I=o("8336"),R=o("b0af"),W=o("99d9"),L=o("169a"),z=o("8e36"),F=Object(P["a"])(M,r,c,!1,null,null,null);F.options.__file="Graph.vue";var N=F.exports;H()(F,{VBtn:I["a"],VCard:R["a"],VCardText:W["a"],VDialog:L["a"],VProgressLinear:z["a"]});var V={name:"App",components:{Graph:N},data(){return{}}},U=V,q=o("7496"),G=o("549c"),K=Object(P["a"])(U,a,s,!1,null,null,null);K.options.__file="App.vue";var J=K.exports;H()(K,{VApp:q["a"],VContent:G["a"]}),i["a"].config.productionTip=!1,new i["a"]({store:S,render:t=>t(J)}).$mount("#app")},"8e60":function(t,e,o){"use strict";var i=o("af4a"),n=o.n(i);n.a},af4a:function(t,e,o){}});
//# sourceMappingURL=app.63f84c99.js.map