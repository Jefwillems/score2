(function(t){function e(e){for(var r,s,a=e[0],c=e[1],l=e[2],d=0,u=[];d<a.length;d++)s=a[d],n[s]&&u.push(n[s][0]),n[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);p&&p(e);while(u.length)u.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],r=!0,a=1;a<i.length;a++){var c=i[a];0!==n[c]&&(r=!1)}r&&(o.splice(e--,1),t=s(s.s=i[0]))}return t}var r={},n={app:0},o=[];function s(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=r,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/score2/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var p=c;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"56d7":function(t,e,i){"use strict";i.r(e);var r=i("2b0e"),n=i("bb71");i("da64");r["a"].use(n["a"],{iconfont:"md"});var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",[i("v-content",[i("Graph")],1)],1)},s=[],a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[""!==t.topic?i("div",{staticClass:"topic"},[i("h3",{staticClass:"text-xs-center"},[t._v("Current topic: "),i("span",[t._v(t._s(t.topic))])])]):t._e(),i("div",{ref:"graph",style:t.sizeProps,attrs:{id:"graph"}}),i("v-btn",{attrs:{color:"warning"},on:{click:t.reload}},[t._v(t._s(t.btnText))]),i("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",{attrs:{color:"primary",dark:""}},[i("v-card-text",[t._v("\n        Please stand by\n        "),i("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},c=[],l=i("2f62"),p={MUTATE_RAW_DATA:"mutate_raw_data",FETCH_SPREADSHEET_DATA:"fetch_spreadsheet",HANDLE_CLICK:"handle_click",RESET_BUTTON:"reset_button",SELECT_CITY:"select_city"},d=i("2ef0");const u=t=>{let e=0;return t.entry.map(t=>{const{gsx$city:{$t:i},gsx$contact:{$t:r},gsx$description:{$t:n},gsx$keywords:{$t:o},gsx$title:{$t:s},gsx$topics:{$t:a}}=t,c={city:i,contact:r,description:n,title:s,keywords:o.split(", ").filter(t=>""!==t),topics:a.split(", ").filter(t=>""!==t),id:++e,label:i};return c})},h={shape:"hexagon",mass:2,fixed:!1},b={...h,type:"city",color:"rgba(6,133,135,1)"},f={...h,type:"keywords",color:"rgba(79, 185, 159, 1)"},g={...h,type:"challenge",color:"rgba(242, 177, 52, 1)"},_={...h,type:"topics",color:"rgba(237, 85, 59, 1)"},y=[{...b,fixed:!0,physics:!1,size:25,x:25,y:0,label:"city"},{...f,fixed:!0,physics:!1,size:25,x:25,y:50,label:"keyword"},{...g,fixed:!0,physics:!1,size:25,x:25,y:100,label:"challenge"},{..._,fixed:!0,physics:!1,size:25,x:25,y:150,label:"topic"}],v=t=>{return Object(d["uniqBy"])(t,"city").map(t=>t.city).filter(t=>""!==t)},j=t=>e=>{return Object(d["union"])(...t.map(t=>t[e])).filter(t=>""!==t)},O=t=>e=>{return Object(d["filter"])(e,e=>Object(d["includes"])(e.topics,t.label)).length},m=(t,e)=>{const[i,r]=Object(d["partition"])(t,t=>"city"===t.type),n=[];return Object(d["forEach"])(r,t=>{const r=O(t);Object(d["forEach"])(i,i=>{n.push(...Object(d["times"])(r(e[i.label]),()=>({from:i.id,to:t.id})))})}),n},w=t=>{const e=t[t.focus].map(e=>({..._,label:e,type:t.focus})),i=t.cities.map(t=>({label:t,...b}));let r=0;return Object(d["flatMap"])([e,i],t=>Object(d["map"])(t,t=>({...t,id:++r})))};var x={mutate_raw_data(t,{feed:e}){const i=u(e),r=v(i),n=j(i),o=n("keywords"),s=n("topics"),a=Object(d["groupBy"])(Object(d["filter"])(i,t=>""!==t.city),"city");t.raw_data=a,t.cities=r.sort(),t.selected_cities=r.sort(),t.keywords=o,t.topics=s;const c=w(t),l=m(c,a);t.graph={nodes:c,edges:l}},handle_click(t,{nodes:e}){const i=Object(d["find"])(t.graph.nodes,t=>t.id===e[0]&&"topics"===t.type);if(i){t.btnText="back",t.selected_topic={...i},t.topic=t.selected_topic.label;const e=Object(d["map"])(t.cities,t=>({label:t,...b})),r=Object(d["filter"])(Object(d["flatMap"])(e,e=>t.raw_data[e.label]),e=>Object(d["includes"])(e.topics,t.selected_topic.label)),n=Object(d["map"])(r,t=>({label:t.title,city:t.city,...g})),o=Object(d["map"])(Object(d["uniq"])(Object(d["flatMap"])(r,t=>t.keywords)),t=>({label:t,...f}));let s=0;const a=Object(d["map"])(Object(d["concat"])(n,e,o),t=>({...t,id:++s})),c=Object(d["map"])(Object(d["filter"])(a,t=>"challenge"===t.type),t=>({from:t.id,to:Object(d["find"])(a,e=>e.label===t.city).id})),l=Object(d["flatMap"])(Object(d["filter"])(a,t=>"challenge"===t.type),e=>{const{keywords:i}=Object(d["find"])(t.raw_data[e.city],t=>t.title===e.label);return Object(d["map"])(i,t=>({from:Object(d["find"])(a,e=>e.label===t).id,to:e.id}))}),p=Object(d["concat"])(c,l);t.graph={nodes:a,edges:p}}},reset_button(t){t.btnText="reload"},select_city({selected_cities:t},e){t=Object(d["find"])(t,e)?Object(d["filter"])(t,t=>t===e):[...t,e]}};const T=t=>fetch(t).then(t=>t.json());var E={fetch_spreadsheet({commit:t}){const e="https://spreadsheets.google.com/feeds/list/1adKrrgn-KxFe1mWHUXZEDvu23BIzHE2wLk2YfIQjzbM/1/public/values?alt=json";T(e).then(e=>{t(p.MUTATE_RAW_DATA,e),t(p.RESET_BUTTON)}).catch(t=>console.log(t))}},k={get_nodes_and_edges({graph:t}){return t},get_options:({options:t})=>t,btnText:({btnText:t})=>t,cities:({cities:t})=>t,selected_cities:({selected_cities:t})=>t,topic:({topic:t})=>t};r["a"].use(l["a"]);var $=new l["a"].Store({state:{topic:"",graph:{nodes:[],edges:[]},focus:"topics",cities:[],options:{autoResize:!0,height:"100%",width:"100%"},raw_data:{},btnText:"Reload",selected_topic:{},selected_cities:[]},mutations:x,actions:E,getters:k});const A=y;var C=i("4f27"),S={name:"Graph",data(){return{events:["doubleClick"],network:null,dialog:!1}},props:{width:{type:String,default:function(){return"100vw"}},height:{type:String,default:function(){return"75vh"}}},computed:{...Object(l["c"])([]),...Object(l["b"])(["get_nodes_and_edges","get_options","btnText","topic"]),sizeProps(){return{width:`${this.$props.width}`,height:`${this.$props.height}`,"min-height":`${this.$props.height}`}}},created(){},mounted(){this.dialog=!0,this.$store.dispatch(p.FETCH_SPREADSHEET_DATA)},methods:{reload(){this.dialog=!0,this.$store.state.topic="",this.$store.dispatch(p.FETCH_SPREADSHEET_DATA)},handle_event(t,e){switch(t){case"doubleClick":this.dialog=!0,this.$store.commit(p.HANDLE_CLICK,e);break;default:return}}},watch:{get_nodes_and_edges:function(t){null!==this.network&&this.network.destroy();const e=this.$refs.graph,i=-e.clientWidth/2-50;let r=-e.clientHeight/2-50;const n=A.map(t=>{const e={...t,x:i,y:r};return r+=75,e});t.nodes.push(...n),this.network=new C["Network"](e,t,this.get_options),this.events.forEach(t=>this.network.on(t,e=>this.handle_event(t,e))),this.network.on("afterDrawing",()=>this.dialog=!1)}}},D=S,P=(i("8e60"),i("2877")),H=i("6544"),M=i.n(H),z=i("8336"),R=i("b0af"),L=i("99d9"),V=i("169a"),B=i("8e36"),I=Object(P["a"])(D,a,c,!1,null,null,null);I.options.__file="Graph.vue";var N=I.exports;M()(I,{VBtn:z["a"],VCard:R["a"],VCardText:L["a"],VDialog:V["a"],VProgressLinear:B["a"]});var U={name:"App",components:{Graph:N},data(){return{}}},F=U,G=i("7496"),K=i("549c"),W=Object(P["a"])(F,o,s,!1,null,null,null);W.options.__file="App.vue";var q=W.exports;M()(W,{VApp:G["a"],VContent:K["a"]}),r["a"].config.productionTip=!1,new r["a"]({store:$,render:t=>t(q)}).$mount("#app")},"8e60":function(t,e,i){"use strict";var r=i("af4a"),n=i.n(r);n.a},af4a:function(t,e,i){}});
//# sourceMappingURL=app.9b022a6e.js.map