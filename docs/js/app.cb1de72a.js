(function(t){function e(e){for(var r,i,a=e[0],c=e[1],l=e[2],u=0,d=[];u<a.length;u++)i=a[u],o[i]&&d.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);p&&p(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},o={app:0},s=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/score2/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var p=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);var r=n("2b0e"),o=n("bb71");n("da64");r["a"].use(o["a"],{iconfont:"md"});var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-content",[n("Graph")],1)],1)},i=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{ref:"graph",style:t.sizeProps,attrs:{id:"graph"}}),n("v-btn",{attrs:{color:"warning"},on:{click:t.buttonClicked}},[t._v("Reload")])],1)},c=[],l=n("2f62"),p={MUTATE_RAW_DATA:"mutate_raw_data",FETCH_SPREADSHEET_DATA:"fetch_spreadsheet",HANDLE_CLICK:"handle_click"},u=n("4f27"),d=n.n(u),h={name:"Graph",data(){return{events:["selectNode","selectEdge","deselectNode","deselectEdge","doubleClick"],network:null}},props:{width:{type:String,default:function(){return"100%"}},height:{type:String,default:function(){return"100vh"}}},computed:{...Object(l["c"])([]),...Object(l["b"])(["get_nodes_and_edges","get_options"]),sizeProps(){return{width:`${this.$props.width}`,height:`${this.$props.height}`,"min-height":`${this.$props.height}`}}},created(){},mounted(){this.$store.dispatch(p.FETCH_SPREADSHEET_DATA)},methods:{buttonClicked(){this.$store.dispatch(p.FETCH_SPREADSHEET_DATA)},handle_event(t,e){switch(t){case"doubleClick":this.$store.commit(p.HANDLE_CLICK,e);break;default:return}}},watch:{get_nodes_and_edges:function(t){null!==this.network&&this.network.destroy();const e=this.$refs.graph;this.network=new d.a.Network(e,t,this.get_options),this.events.forEach(t=>this.network.on(t,e=>this.handle_event(t,e)))}}},f=h,g=(n("8e60"),n("2877")),b=n("6544"),_=n.n(b),v=n("8336"),y=Object(g["a"])(f,a,c,!1,null,null,null);y.options.__file="Graph.vue";var w=y.exports;_()(y,{VBtn:v["a"]});var m={name:"App",components:{Graph:w},data(){return{}}},j=m,O=n("7496"),E=n("549c"),$=Object(g["a"])(j,s,i,!1,null,null,null);$.options.__file="App.vue";var k=$.exports;_()($,{VApp:O["a"],VContent:E["a"]});var A=n("2ef0");const T=t=>{let e=0;return t.entry.map(t=>{const{gsx$city:{$t:n},gsx$contact:{$t:r},gsx$description:{$t:o},gsx$keywords:{$t:s},gsx$title:{$t:i},gsx$topics:{$t:a}}=t,c={city:n,contact:r,description:o,title:i,keywords:s.split(", ").filter(t=>""!==t),topics:a.split(", ").filter(t=>""!==t),id:++e,label:n};return c})},x=t=>{return Object(A["uniqBy"])(t,"city").map(t=>t.city).filter(t=>""!==t)},S=t=>e=>{return Object(A["union"])(...t.map(t=>t[e])).filter(t=>""!==t)},C=t=>e=>{return Object(A["filter"])(e,e=>Object(A["includes"])(e.topics,t.label)).length},D=(t,e)=>{const[n,r]=Object(A["partition"])(t,t=>"city"===t.type),o=[];return Object(A["forEach"])(r,t=>{const r=C(t);Object(A["forEach"])(n,n=>{o.push(...Object(A["times"])(r(e[n.label]),()=>({from:n.id,to:t.id})))})}),o},P=t=>{const e=t[t.focus].map(e=>({label:e,type:t.focus})),n=t.cities.map(t=>({label:t,type:"city",color:"rgba(120,32,14,1)",font:{color:"white"}}));let r=0;return Object(A["flatMap"])([e,n],t=>Object(A["map"])(t,t=>({...t,id:++r})))};var H={mutate_raw_data(t,{feed:e}){const n=T(e),r=x(n),o=S(n),s=o("keywords"),i=o("topics"),a=Object(A["groupBy"])(Object(A["filter"])(n,t=>""!==t.city),"city");t.raw_data=a,t.cities=r,t.keywords=s,t.topics=i;const c=P(t),l=D(c,a);t.graph={nodes:c,edges:l}},handle_click(t,{nodes:e}){const n=Object(A["find"])(t.graph.nodes,t=>t.id===e[0]&&"topics"===t.type);console.log(n),n&&console.log(n)}};const M=t=>fetch(t).then(t=>t.json());var R={fetch_spreadsheet({commit:t}){const e="https://spreadsheets.google.com/feeds/list/1adKrrgn-KxFe1mWHUXZEDvu23BIzHE2wLk2YfIQjzbM/1/public/values?alt=json";M(e).then(e=>t(p.MUTATE_RAW_DATA,e)).catch(t=>console.log(t))}},z={get_nodes_and_edges({graph:t}){return t},get_options:({options:t})=>t};r["a"].use(l["a"]);var L=new l["a"].Store({state:{graph:{nodes:[],edges:[]},focus:"topics",cities:[],options:{autoResize:!0,height:"100%",width:"100%",nodes:{shape:"circle"}},raw_data:{}},mutations:H,actions:R,getters:z});r["a"].config.productionTip=!1,new r["a"]({store:L,render:t=>t(k)}).$mount("#app")},"8e60":function(t,e,n){"use strict";var r=n("af4a"),o=n.n(r);o.a},af4a:function(t,e,n){}});
//# sourceMappingURL=app.cb1de72a.js.map