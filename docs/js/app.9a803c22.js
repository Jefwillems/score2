(function(t){function e(e){for(var r,a,i=e[0],s=e[1],l=e[2],d=0,u=[];d<i.length;d++)a=i[d],o[a]&&u.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);p&&p(e);while(u.length)u.shift()();return c.push.apply(c,l||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],r=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(r=!1)}r&&(c.splice(e--,1),t=a(a.s=n[0]))}return t}var r={},o={app:0},c=[];function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/score2/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var p=s;c.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);var r=n("2b0e"),o=n("bb71");n("da64");r["a"].use(o["a"],{iconfont:"md"});var c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-content",[n("Graph")],1)],1)},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{ref:"graph",style:t.sizeProps,attrs:{id:"graph"}}),n("v-btn",{attrs:{color:"warning"},on:{click:t.reload}},[t._v(t._s(t.btnText))])],1)},s=[],l=n("2f62"),p={MUTATE_RAW_DATA:"mutate_raw_data",FETCH_SPREADSHEET_DATA:"fetch_spreadsheet",HANDLE_CLICK:"handle_click",RESET_BUTTON:"reset_button"},d=n("4f27"),u=n.n(d),f={name:"Graph",data(){return{events:["doubleClick"],network:null}},props:{width:{type:String,default:function(){return"100%"}},height:{type:String,default:function(){return"90vh"}}},computed:{...Object(l["c"])([]),...Object(l["b"])(["get_nodes_and_edges","get_options","btnText"]),sizeProps(){return{width:`${this.$props.width}`,height:`${this.$props.height}`,"min-height":`${this.$props.height}`}}},created(){},mounted(){this.$store.dispatch(p.FETCH_SPREADSHEET_DATA)},methods:{reload(){this.$store.dispatch(p.FETCH_SPREADSHEET_DATA)},handle_event(t,e){switch(t){case"doubleClick":this.$store.commit(p.HANDLE_CLICK,e);break;default:return}}},watch:{get_nodes_and_edges:function(t){null!==this.network&&this.network.destroy();const e=this.$refs.graph;this.network=new u.a.Network(e,t,this.get_options),this.events.forEach(t=>this.network.on(t,e=>this.handle_event(t,e)))}}},h=f,b=(n("8e60"),n("2877")),g=n("6544"),_=n.n(g),y=n("8336"),j=Object(b["a"])(h,i,s,!1,null,null,null);j.options.__file="Graph.vue";var O=j.exports;_()(j,{VBtn:y["a"]});var v={name:"App",components:{Graph:O},data(){return{}}},m=v,w=n("7496"),T=n("549c"),E=Object(b["a"])(m,c,a,!1,null,null,null);E.options.__file="App.vue";var $=E.exports;_()(E,{VApp:w["a"],VContent:T["a"]});var k=n("2ef0");const x=t=>{let e=0;return t.entry.map(t=>{const{gsx$city:{$t:n},gsx$contact:{$t:r},gsx$description:{$t:o},gsx$keywords:{$t:c},gsx$title:{$t:a},gsx$topics:{$t:i}}=t,s={city:n,contact:r,description:o,title:a,keywords:c.split(", ").filter(t=>""!==t),topics:i.split(", ").filter(t=>""!==t),id:++e,label:n};return s})},A={type:"city",color:"rgba(120,32,14,1)",font:{color:"white"}},S={type:"keywords",color:"rgba(227, 227, 32, 1)"},C={type:"challenge",color:"rgba(132, 75, 190, 1)",font:{color:"white"}},D=t=>{return Object(k["uniqBy"])(t,"city").map(t=>t.city).filter(t=>""!==t)},M=t=>e=>{return Object(k["union"])(...t.map(t=>t[e])).filter(t=>""!==t)},P=t=>e=>{return Object(k["filter"])(e,e=>Object(k["includes"])(e.topics,t.label)).length},H=(t,e)=>{const[n,r]=Object(k["partition"])(t,t=>"city"===t.type),o=[];return Object(k["forEach"])(r,t=>{const r=P(t);Object(k["forEach"])(n,n=>{o.push(...Object(k["times"])(r(e[n.label]),()=>({from:n.id,to:t.id})))})}),o},R=t=>{const e=t[t.focus].map(e=>({label:e,type:t.focus})),n=t.cities.map(t=>({label:t,...A}));let r=0;return Object(k["flatMap"])([e,n],t=>Object(k["map"])(t,t=>({...t,id:++r})))};var B={mutate_raw_data(t,{feed:e}){const n=x(e),r=D(n),o=M(n),c=o("keywords"),a=o("topics"),i=Object(k["groupBy"])(Object(k["filter"])(n,t=>""!==t.city),"city");t.raw_data=i,t.cities=r,t.keywords=c,t.topics=a;const s=R(t),l=H(s,i);t.graph={nodes:s,edges:l}},handle_click(t,{nodes:e}){const n=Object(k["find"])(t.graph.nodes,t=>t.id===e[0]&&"topics"===t.type);if(n){t.btnText="back",t.selected_topic={...n};const e=Object(k["map"])(t.cities,t=>({label:t,...A})),r=Object(k["filter"])(Object(k["flatMap"])(e,e=>t.raw_data[e.label]),e=>Object(k["includes"])(e.topics,t.selected_topic.label)),o=Object(k["map"])(r,t=>({label:t.title,city:t.city,...C})),c=Object(k["map"])(Object(k["uniq"])(Object(k["flatMap"])(r,t=>t.keywords)),t=>({label:t,...S}));let a=0;const i=Object(k["map"])(Object(k["concat"])(o,e,c),t=>({...t,id:++a})),s=Object(k["map"])(Object(k["filter"])(i,t=>"challenge"===t.type),t=>({from:t.id,to:Object(k["find"])(i,e=>e.label===t.city).id})),l=Object(k["flatMap"])(Object(k["filter"])(i,t=>"challenge"===t.type),e=>{const{keywords:n}=Object(k["find"])(t.raw_data[e.city],t=>t.title===e.label);return Object(k["map"])(n,t=>({from:Object(k["find"])(i,e=>e.label===t).id,to:e.id}))});console.log(l);const p=Object(k["concat"])(s,l);t.graph={nodes:i,edges:p}}},reset_button(t){t.btnText="reload"}};const z=t=>fetch(t).then(t=>t.json());var L={fetch_spreadsheet({commit:t}){const e="https://spreadsheets.google.com/feeds/list/1adKrrgn-KxFe1mWHUXZEDvu23BIzHE2wLk2YfIQjzbM/1/public/values?alt=json";z(e).then(e=>{t(p.MUTATE_RAW_DATA,e),t(p.RESET_BUTTON)}).catch(t=>console.log(t))}},N={get_nodes_and_edges({graph:t}){return t},get_options:({options:t})=>t,btnText:({btnText:t})=>t};r["a"].use(l["a"]);var U=new l["a"].Store({state:{graph:{nodes:[],edges:[]},focus:"topics",cities:[],options:{autoResize:!0,height:"100%",width:"100%",nodes:{shape:"circle"}},raw_data:{},btnText:"Reload",selected_topic:{}},mutations:B,actions:L,getters:N});r["a"].config.productionTip=!1,new r["a"]({store:U,render:t=>t($)}).$mount("#app")},"8e60":function(t,e,n){"use strict";var r=n("af4a"),o=n.n(r);o.a},af4a:function(t,e,n){}});
//# sourceMappingURL=app.9a803c22.js.map