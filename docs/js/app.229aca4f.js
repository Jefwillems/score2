(function(t){function e(e){for(var n,i,s=e[0],c=e[1],l=e[2],p=0,u=[];p<s.length;p++)i=s[p],o[i]&&u.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);d&&d(e);while(u.length)u.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var t,e=0;e<a.length;e++){for(var r=a[e],n=!0,s=1;s<r.length;s++){var c=r[s];0!==o[c]&&(n=!1)}n&&(a.splice(e--,1),t=i(i.s=r[0]))}return t}var n={},o={app:0},a=[];function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/score2/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var d=c;a.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"56d7":function(t,e,r){"use strict";r.r(e);var n=r("2b0e"),o=r("bb71");r("da64");n["a"].use(o["a"],{iconfont:"md"});var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-content",[r("Graph")],1)],1)},i=[],s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",{ref:"graph",style:t.sizeProps,attrs:{id:"graph"}}),r("v-btn",{attrs:{color:"warning"},on:{click:t.reload}},[t._v(t._s(t.btnText))]),r("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[t._v("\n        Please stand by\n        "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},c=[],l=r("2f62"),d={MUTATE_RAW_DATA:"mutate_raw_data",FETCH_SPREADSHEET_DATA:"fetch_spreadsheet",HANDLE_CLICK:"handle_click",RESET_BUTTON:"reset_button",SELECT_CITY:"select_city"},p=r("4f27"),u=r.n(p),f={name:"Graph",data(){return{events:["doubleClick"],network:null,dialog:!1}},props:{width:{type:String,default:function(){return"100%"}},height:{type:String,default:function(){return"90vh"}}},computed:{...Object(l["c"])([]),...Object(l["b"])(["get_nodes_and_edges","get_options","btnText"]),sizeProps(){return{width:`${this.$props.width}`,height:`${this.$props.height}`,"min-height":`${this.$props.height}`}}},created(){},mounted(){this.dialog=!0,this.$store.dispatch(d.FETCH_SPREADSHEET_DATA)},methods:{reload(){this.dialog=!0,this.$store.dispatch(d.FETCH_SPREADSHEET_DATA)},handle_event(t,e){switch(t){case"doubleClick":this.dialog=!0,this.$store.commit(d.HANDLE_CLICK,e);break;default:return}}},watch:{get_nodes_and_edges:function(t){null!==this.network&&this.network.destroy();const e=this.$refs.graph;this.network=new u.a.Network(e,t,this.get_options),this.events.forEach(t=>this.network.on(t,e=>this.handle_event(t,e))),this.network.on("afterDrawing",()=>this.dialog=!1)}}},h=f,b=(r("8e60"),r("2877")),g=r("6544"),_=r.n(g),y=r("8336"),v=r("b0af"),j=r("99d9"),O=r("169a"),m=r("8e36"),w=Object(b["a"])(h,s,c,!1,null,null,null);w.options.__file="Graph.vue";var T=w.exports;_()(w,{VBtn:y["a"],VCard:v["a"],VCardText:j["a"],VDialog:O["a"],VProgressLinear:m["a"]});var E={name:"App",components:{Graph:T},data(){return{}}},k=E,x=r("7496"),$=r("549c"),A=Object(b["a"])(k,a,i,!1,null,null,null);A.options.__file="App.vue";var S=A.exports;_()(A,{VApp:x["a"],VContent:$["a"]});var C=r("2ef0");const D=t=>{let e=0;return t.entry.map(t=>{const{gsx$city:{$t:r},gsx$contact:{$t:n},gsx$description:{$t:o},gsx$keywords:{$t:a},gsx$title:{$t:i},gsx$topics:{$t:s}}=t,c={city:r,contact:n,description:o,title:i,keywords:a.split(", ").filter(t=>""!==t),topics:s.split(", ").filter(t=>""!==t),id:++e,label:r};return c})},P={shape:"hexagon",mass:2,fixed:!1},M={...P,type:"city",color:"rgba(178,114,112,1)"},H={...P,type:"keywords",color:"rgba(249, 255, 127, 1)"},R={...P,type:"challenge",color:"rgba(61, 139, 204, 1)"},L={...P,type:"topics",color:"rgba(255, 107, 101, 1)"},V=t=>{return Object(C["uniqBy"])(t,"city").map(t=>t.city).filter(t=>""!==t)},B=t=>e=>{return Object(C["union"])(...t.map(t=>t[e])).filter(t=>""!==t)},z=t=>e=>{return Object(C["filter"])(e,e=>Object(C["includes"])(e.topics,t.label)).length},I=(t,e)=>{const[r,n]=Object(C["partition"])(t,t=>"city"===t.type),o=[];return Object(C["forEach"])(n,t=>{const n=z(t);Object(C["forEach"])(r,r=>{o.push(...Object(C["times"])(n(e[r.label]),()=>({from:r.id,to:t.id})))})}),o},N=t=>{const e=t[t.focus].map(e=>({...L,label:e,type:t.focus})),r=t.cities.map(t=>({label:t,...M}));let n=0;return Object(C["flatMap"])([e,r],t=>Object(C["map"])(t,t=>({...t,id:++n})))};var U={mutate_raw_data(t,{feed:e}){const r=D(e),n=V(r),o=B(r),a=o("keywords"),i=o("topics"),s=Object(C["groupBy"])(Object(C["filter"])(r,t=>""!==t.city),"city");t.raw_data=s,t.cities=n.sort(),t.selected_cities=n.sort(),t.keywords=a,t.topics=i;const c=N(t),l=I(c,s);t.graph={nodes:c,edges:l}},handle_click(t,{nodes:e}){const r=Object(C["find"])(t.graph.nodes,t=>t.id===e[0]&&"topics"===t.type);if(r){t.btnText="back",t.selected_topic={...r};const e=Object(C["map"])(t.cities,t=>({label:t,...M})),n=Object(C["filter"])(Object(C["flatMap"])(e,e=>t.raw_data[e.label]),e=>Object(C["includes"])(e.topics,t.selected_topic.label)),o=Object(C["map"])(n,t=>({label:t.title,city:t.city,...R})),a=Object(C["map"])(Object(C["uniq"])(Object(C["flatMap"])(n,t=>t.keywords)),t=>({label:t,...H}));let i=0;const s=Object(C["map"])(Object(C["concat"])(o,e,a),t=>({...t,id:++i})),c=Object(C["map"])(Object(C["filter"])(s,t=>"challenge"===t.type),t=>({from:t.id,to:Object(C["find"])(s,e=>e.label===t.city).id})),l=Object(C["flatMap"])(Object(C["filter"])(s,t=>"challenge"===t.type),e=>{const{keywords:r}=Object(C["find"])(t.raw_data[e.city],t=>t.title===e.label);return Object(C["map"])(r,t=>({from:Object(C["find"])(s,e=>e.label===t).id,to:e.id}))});console.log(l);const d=Object(C["concat"])(c,l);t.graph={nodes:s,edges:d}}},reset_button(t){t.btnText="reload"},select_city({selected_cities:t},e){t=Object(C["find"])(t,e)?Object(C["filter"])(t,t=>t===e):[...t,e]}};const F=t=>fetch(t).then(t=>t.json());var G={fetch_spreadsheet({commit:t}){const e="https://spreadsheets.google.com/feeds/list/1adKrrgn-KxFe1mWHUXZEDvu23BIzHE2wLk2YfIQjzbM/1/public/values?alt=json";F(e).then(e=>{t(d.MUTATE_RAW_DATA,e),t(d.RESET_BUTTON)}).catch(t=>console.log(t))}},K={get_nodes_and_edges({graph:t}){return t},get_options:({options:t})=>t,btnText:({btnText:t})=>t,cities:({cities:t})=>t,selected_cities:({selected_cities:t})=>t};n["a"].use(l["a"]);var W=new l["a"].Store({state:{graph:{nodes:[],edges:[]},focus:"topics",cities:[],options:{autoResize:!0,height:"100%",width:"100%"},raw_data:{},btnText:"Reload",selected_topic:{},selected_cities:[]},mutations:U,actions:G,getters:K});n["a"].config.productionTip=!1,new n["a"]({store:W,render:t=>t(S)}).$mount("#app")},"8e60":function(t,e,r){"use strict";var n=r("af4a"),o=r.n(n);o.a},af4a:function(t,e,r){}});
//# sourceMappingURL=app.229aca4f.js.map